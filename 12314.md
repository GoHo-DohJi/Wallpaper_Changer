# SLIDESHOW — Windows Wallpaper Scheduler (PowerShell Guide)

Minimal Windows wallpaper switcher designed to run from **Task Scheduler**
(e.g. every 5 minutes)

## What this program does

- Sets **different wallpapers on each monitor**
- Uses a **persistent randomized queue**
- Guarantees that **all images are used once per cycle**
- Saves state between runs
- No UI, no services, no registry usage
- Designed to run silently every few minutes

---

## Where data is stored

The program uses LocalAppData:

%LOCALAPPDATA%\SLIDESHOW
├─ queue.txt
└─ BACKGROUND
	├─ image1.jpg
	├─ image2.png
	├─ image3.webp
	└─ ...

Supported formats:
- jpg
- jpeg
- png
- bmp
- webp

---

## STEP 1 — Install C++ compiler (MSVC) via winget

Open **PowerShell as Administrator** and run:

```powershell
winget install --silent --accept-source-agreements --accept-package-agreements --source "winget" --exact --id "Microsoft.VisualStudio.BuildTools"
```

During installation, select:
	•	✔ MSVC v143 - VS 2022 C++ x64/x86 build tools
	•	✔ Windows 10/11 SDK
	
⸻

STEP 2 — Open MSVC build environment (PowerShell)

Run:

```powershell
cmd /k '"C:\Program Files (x86)\Microsoft Visual Studio\18\BuildTools\VC\Auxiliary\Build\vcvars64.bat"'
```

This opens a cmd window with MSVC environment initialized.

Verify:

```powershell
cl
```

You should see: usage: 

```powershell
cl [ option... ] filename... [ /link linkoption... ]
```

⸻

STEP 3 — Build the program

```powershell
cd {PATH_TO_PROJECT}\SLIDESHOW

cl SRC\SLIDESHOW.cpp ^
  /std:c++20 ^
  /O2 /Ob2 /Oi /Ot /Oy ^
  /GL ^
  /MT ^
  /EHsc ^
  /GR- ^
  /DNDEBUG ^
  /link ^
  ole32.lib shell32.lib ^
  /SUBSYSTEM:WINDOWS ^
  /OPT:REF /OPT:ICF ^
  /LTCG ^
  /MANIFEST:EMBED ^
  /MANIFESTINPUT:SRC\SLIDESHOW.manifest ^
  /OUT:SLIDESHOW.exe
```

Result:

```powershell
SLIDESHOW.exe
```

⸻

STEP 4 — Unblock the EXE (IMPORTANT)

If the EXE was downloaded or copied from another system,
Windows may block it.

Run in PowerShell:

```powershell
Unblock-File .\SLIDESHOW.exe
```

! Without this step, the program may silently fail !

⸻

STEP 5 — Download Wallpapers (from GitHub)

Public wallpaper repository:

```powershell 
https://github.com/GoHo-DohJi/WALLPAPER/tree/main/BACKGROUND
```

Automatic download via PowerShell

Run:

```powershell 
# Target directory (used by SLIDESHOW.exe)
$target = "$env:LOCALAPPDATA\SLIDESHOW\BACKGROUND"
New-Item -ItemType Directory -Force -Path $target | Out-Null

# Temporary paths
$tempZip = "$env:TEMP\WALLPAPER.zip"
$tempDir = "$env:TEMP\WALLPAPER_extract"

# Download repository as ZIP
Invoke-WebRequest `
  -Uri "https://github.com/GoHo-DohJi/WALLPAPER/archive/refs/heads/main.zip" `
  -OutFile $tempZip

# Extract ZIP
Expand-Archive -Force $tempZip $tempDir

# Copy wallpapers
Copy-Item `
  "$tempDir\WALLPAPER-main\BACKGROUND\*" `
  $target `
  -Recurse -Force

# Cleanup
Remove-Item $tempZip -Force
Remove-Item $tempDir -Recurse -Force
```

⸻

STEP 6 — Unblock exe file

```powershell 
Unblock-File "C:\Program Files\SLIDESHOW\SLIDESHOW.exe"
```

STEP 7 — First manual run (test)

```powershell 
.\SLIDESHOW.exe
```

	•	No output = success
	•	Wallpapers should change
	•	queue.txt will be created automatically

⸻

STEP 8 — Create Task Scheduler task (PowerShell)

```powershell 
schtasks /create ^
 /sc minute ^
 /mo 5 ^
 /tn "SLIDESHOW" ^
 /tr "C:\Path\To\SLIDESHOW.exe" ^
 /rl HIGHEST ^
 /f
```

Make sure:
	•	Path points to the correct EXE
	•	EXE is unblocked
	•	Wallpapers exist in BACKGROUND folder

⸻

Exit codes

0 = Success | Another instance already running
1 = No images / Not enough images


⸻

Notes
	•	Queue is rebuilt only after full cycle
	•	No directory rescans during normal runs
	•	Images are never repeated between monitors
	•	Safe to run every few minutes for years

⸻
